# 锁
> [CAS机制](https://www.jianshu.com/p/ae25eb3cfb5d)
1. 悲观锁(synchronized)：线程一旦得到锁，其他需要锁的线程就挂起的情况就是悲观锁
2. 乐观锁
    - 乐观锁机制(CAS)：每次不加锁而是假设没有冲突而去完成某项操作，如果因为冲突失败就重试，直到成功为止。

## CAS机制
> CAS（compare and swap）
> 
> 三个基本操作数：内存地址V、旧的预期值A、要修改的新值B
> 
> 更新一个变量的时候，只有当变量的预期值A和内存地址V当中的实际值相同时，才会将内存地址V对应的值修改为B。
>

CAS的缺点：

1.CPU开销较大
在并发量比较高的情况下，如果许多线程反复尝试更新某一个变量，却又一直更新不成功，循环往复，会给CPU带来很大的压力。

2.不能保证代码块的原子性
CAS机制所保证的只是一个变量的原子性操作，而不能保证整个代码块的原子性。比如需要保证3个变量共同进行原子性的更新，就不得不使用Synchronized了。
